(function(b){var f=new google.maps.Geocoder;b.fn.autoGeocoder=function(a){a=b.extend(true,{},b.fn.autoGeocoder.defaults,a||{});var d=a.setup||b.fn.autoGeocoder.base;for(property in d)if(d[property]instanceof Array)for(var e=d[property].length,c=0;c<e;c++)d[property][c].call(this,a);else d[property].call(this,a);return this.trigger("auto-geocoder.initialize")};b.fn.autoGeocoder.base={initialize:[function(a){a.initial.center=new google.maps.LatLng(a.initial.center[0],a.initial.center[1]);this.bind("auto-geocoder.initialize",
function(){b(this).trigger("auto-geocoder.createMap").trigger("auto-geocoder.onKeyUp")})}],createMap:[function(a){this.bind("auto-geocoder.createMap",function(){var d=b("<div>",{"class":a.className});a.position=="before"||a.position=="after"?b(this)[a.position](d):b(a.position).append(d);b(this).bind("keyup.auto-geocoder",function(){b(this).trigger("auto-geocoder.onKeyUp")});this.map=new google.maps.Map(d[0],a.initial)})}],onKeyUp:[function(a){this.bind("auto-geocoder.onKeyUp",function(){var d=this,
e=b(this),c=b.trim(e.val()).replace(/\s+/g," ").toLowerCase();this.timeout&&clearTimeout(this.timeout);if(!(this.previousAddress&&this.previousAddress==c))if(c=="")e.trigger("auto-geocoder.onGeocodeResult",[[],""]);else this.timeout=setTimeout(function(){d.previousAddress=c;f.geocode({address:c},function(g,h){e.trigger("auto-geocoder.onGeocodeResult",[g,h])})},a.delay)})}],onGeocodeResult:[function(a){this.bind("auto-geocoder.onGeocodeResult",function(d,e,c){if(c==google.maps.GeocoderStatus.OK&&c!=
google.maps.GeocoderStatus.ZERO_RESULTS){if(a.success.zoom=="auto")this.map.fitBounds(e[0].geometry.viewport);else{this.map.setZoom(a.success.zoom);this.map.setCenter(e[0].geometry.location)}this.marker=this.marker||new google.maps.Marker;this.marker.setPosition(e[0].geometry.location);this.marker.setMap(this.map);b(this).trigger("auto-geocoder.onGeocodeSuccess",[e,c])}else{if(this.marker){this.marker.setMap(null);delete this.marker}this.map.setZoom(a.initial.zoom);this.map.setCenter(a.initial.center);
b(this).trigger("auto-geocoder.onGeocodeFailure",[e,c])}})}],onGeocodeSuccess:[],onGeocodeFailure:[]};b.fn.autoGeocoder.defaults={className:"jquery-auto-geocoder-map",position:"after",delay:500,success:{zoom:"auto"},initial:{zoom:1,center:[34,0],draggable:false,mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:false}}})(jQuery);
