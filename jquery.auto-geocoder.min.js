(function(b){var f=new google.maps.Geocoder;b.fn.autoGeocoder=function(a){a=b.extend(true,{},b.fn.autoGeocoder.defaults,a||{});this.setupExtras(a.setup||b.fn.autoGeocoder.base,a).trigger("auto-geocoder.initialize");return this};b.fn.autoGeocoder.base={initialize:[function(a){a.initial.center=new google.maps.LatLng(a.initial.center[0],a.initial.center[1]);this.bind("auto-geocoder.initialize",function(){b(this).trigger("auto-geocoder.createMap").trigger("auto-geocoder.onKeyUp")})}],createMap:[function(a){this.bind("auto-geocoder.createMap",function(){var e=b('<div class="'+a.className+'" />');a.position=="before"||a.position=="after"?b(this)[a.position](e):b(a.position).append(e);b(this).bind("keyup.auto-geocoder",function(){b(this).trigger("auto-geocoder.onKeyUp")});this.map=new google.maps.Map(e[0],a.initial)})}],onKeyUp:[function(a){this.bind("auto-geocoder.onKeyUp",function(){var e=this,d=b(this),c=b.trim(d.val()).replace(/\s+/g," ").toLowerCase();this.timeout&&clearTimeout(this.timeout);if(!(this.previousAddress&&this.previousAddress==c))if(c=="")d.trigger("auto-geocoder.onGeocodeResult",[[],""]);else this.timeout=setTimeout(function(){e.previousAddress=c;f.geocode({address:c},function(g,h){d.trigger("auto-geocoder.onGeocodeResult",[g,h])})},a.delay)})}],onGeocodeResult:[function(a){this.bind("auto-geocoder.onGeocodeResult",function(e,d,c){if(c==google.maps.GeocoderStatus.OK&&c!=google.maps.GeocoderStatus.ZERO_RESULTS){if(a.success.zoom=="auto")this.map.fitBounds(d[0].geometry.viewport);else{this.map.setZoom(a.success.zoom);this.map.setCenter(d[0].geometry.location)}this.marker=this.marker||new google.maps.Marker;this.marker.setPosition(d[0].geometry.location);this.marker.setMap(this.map);b(this).trigger("auto-geocoder.onGeocodeSuccess",[d,c])}else{if(this.marker){this.marker.setMap(null);delete this.marker}this.map.setZoom(a.initial.zoom);this.map.setCenter(a.initial.center);b(this).trigger("auto-geocoder.onGeocodeFailure",[d,c])}})}],onGeocodeSuccess:[],onGeocodeFailure:[]};b.fn.autoGeocoder.defaults={className:"jquery-auto-geocoder-map",position:"after",delay:500,success:{zoom:"auto"},initial:{zoom:1,center:[34,0],draggable:false,mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:false}};b.fn.setupExtras=b.fn.setupExtras||function(a,e){for(property in a)if(a[property]instanceof Array)for(var d=a[property].length,c=0;c<d;c++)a[property][c].call(this,e);else a[property].call(this,e);return this}})(jQuery);
